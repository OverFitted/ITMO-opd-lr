<div class="d-flex flex-column min-vh-70">
    <div class="row flex-grow-1 justify-content-center align-items-center">
        <div class="col-auto">
            <button id="startBtn" class="btn btn-primary">Начать тест</button>
            <div id="squareContainer" class="d-none position-relative">
                <div id="square" class="square"></div>
            </div>
            <div id="colorButtons" class="d-none mt-7">
                <div class="row">
                    <div class="col">
                        <button class="btn btn-lg btn-block btn-color" style="background-color: #ff0000;" data-color="0">1</button>
                    </div>
                    <div class="col">
                        <button class="btn btn-lg btn-block btn-color" style="background-color: #00ff00;" data-color="1">2</button>
                    </div>
                    <div class="col">
                        <button class="btn btn-lg btn-block btn-color" style="background-color: #0000ff;" data-color="2">3</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .square {
        width: 100px;
        height: 100px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .btn-color {
        margin: 5px;
    }
</style>

<script>
    const startBtn = document.getElementById('startBtn');
    const squareContainer = document.getElementById('squareContainer');
    const square = document.getElementById('square');
    const colorButtons = document.getElementById('colorButtons');
    const btnColors = document.querySelectorAll('.btn-color');

    const colors = ['#ff0000', '#00ff00', '#0000ff'];
    let currentColor;
    let positiveResults = [];
    let negativeResults = [];
    let clickCount = 0;

    startBtn.addEventListener('click', () => {
        startBtn.classList.add('d-none');
        squareContainer.classList.remove('d-none');
        colorButtons.classList.remove('d-none');
        showSquare();
    });

    function showSquare() {
        const randomColorIndex = Math.floor(Math.random() * colors.length);
        setTimeout(() => {
            square.style.backgroundColor = colors[randomColorIndex];
            startTime = new Date();
        }, Math.random() * 2000 + 500);
    }

    btnColors.forEach((btnColor) => {
        btnColor.addEventListener('click', (event) => {
            const userColor = colors[parseInt(event.target.dataset.color, 10)];
            const reactionTime = new Date().getTime() - startTime;
            if (userColor === currentColor) {
                positiveResults.push(reactionTime);
            } else {
                negativeResults.push(reactionTime)
            }
            clickCount++;
            if (clickCount === 30) {
                sendResults();
            } else {
                square.style.backgroundColor = '';
                showSquare();
            }
        });
    });

    function calculateAverage(array) {
        return array.reduce((a, b) => a + b) / array.length;
    }

    async function sendResults() {
        // Здесь отправляется запрос с результатами на сервер
        // ...

        // Расчет среднего значения и отображение результата
        const average = calculateAverage(results);
        console.log('Среднее время реакции:', average.toFixed(2), 'мс');

        // Здесь вы можете показать модальное окно с результатами или другое уведомление
        // ...
    }
</script>